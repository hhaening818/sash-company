{% extends "base.html" %}

{% block title %}건진창호 | 창호 전문 시공{% endblock %}

{% block extra_style %}
<link rel="preload" as="image"
      href="{{ url_for('static', filename='images/logo.png') }}">

<link rel="preload" as="image"
      href="{{ url_for('static', filename='images/logo-hero.png') }}">

<style>

:root{
    --main-green:#2f7d32;
}

html{
    scroll-behavior:smooth;
}

body{
    margin:0;
    font-family:'Noto Sans KR', sans-serif;
    background:#f0f2f5;
    color:#333;
    overflow-x:hidden;
}


/* =========================
   SECTION
========================= */

section{
    padding:28px 20px;
    text-align:center;
}


/* =========================
   CARD
========================= */

.card{
    background:white;
    padding:26px;
    margin:12px auto;
    width:70%;
    border-radius:15px;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.card:hover{
    transform: translateY(-3px);
    box-shadow:0 8px 20px rgba(0,0,0,0.12);
}


/* =========================
   INPUT
========================= */

input, textarea{
    width:80%;
    padding:10px;
    margin:10px 0;
    border-radius:5px;
    border:1px solid #ccc;
}

button{
    padding:10px 20px;
    background:var(--main-green);
    color:white;
    border:none;
    border-radius:8px;
    cursor:pointer;
}


/* =========================
   SLIDER
========================= */

.slider{
    position:relative;
    max-width:1000px;
    margin:auto;
    overflow:hidden;
}

.slides{
    display:flex;
    transition:transform 0.5s ease;
}

.slide{
    flex:0 0 calc(33.33% - 20px);
    margin:0 10px;
    opacity:0.7;
}

.slide img{
    width:100%;
    height:220px;
    object-fit:cover;
    border-radius:10px;
    cursor:pointer;
}

.prev,.next{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    background:rgba(0,0,0,0.5);
    color:white;
    border:none;
    font-size:28px;
    padding:10px;
    cursor:pointer;
    border-radius:50%;
}

.prev{ left:10px; }
.next{ right:10px; }


/* =========================
   ESTIMATE CARD
========================= */

.estimate-card{
    background:#eef2f1;
    padding:26px;
    margin:12px auto;
    width:70%;
    border-radius:15px;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    transition:0.2s;
}

.estimate-card:hover{
    transform: translateY(-3px);
    box-shadow:0 8px 20px rgba(0,0,0,0.12);
}


/* =========================
   MODAL
========================= */

.modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.6);
    justify-content:center;
    align-items:center;
    z-index:9999;
}

.modal img{
    max-width:90%;
    max-height:90%;
}

.modal-box{
    background:white;
    padding:30px;
    border-radius:15px;
}


/* =========================
   SIGNUP MODAL
========================= */

.signup-modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.35);
    display:none;
    justify-content:center;
    align-items:center;
    z-index:9999;
}

.signup-container{
    width:460px;
    max-width:90%;
    background:white;
    border-radius:16px;
    padding:30px;
}

.signup-title{
    font-size:22px;
    font-weight:700;
    color:#2f7d32;
}

.signup-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.signup-close{
    font-size:22px;
    cursor:pointer;
}


/* =========================
   TERMS
========================= */

.agree-box{
    background:#f8fafc;
    border-radius:10px;
    padding:14px;
    margin-bottom:12px;
}

.terms-content{
    display:none;
    margin-top:10px;
    font-size:13px;
    max-height:220px;
    overflow:auto;
}

.next-btn{
    width:100%;
    padding:12px;
    background:#2f7d32;
    color:white;
    border:none;
    border-radius:8px;
}


/* =========================
   MOBILE
========================= */

@media(max-width:768px){

    .card,
    .estimate-card{
        width:90%;
    }

    .slide{
        flex:0 0 90%;
    }

}

</style>

{% endblock %}


{% block content %}

<!-- hero는 base.html로 이동 예정 -->


<section id="about">

<div class="card">

<h2>회사소개</h2>

<p>

30년 경력의 전문가가 직접 시공합니다.<br>
최고의 단열, 방음, 내구성 보장

</p>

</div>

</section>



<section id="service">

<div class="card">

<h2>시공 분야</h2>

<p>

✔ 아파트 샷시 교체<br>
✔ 단독주택 창호<br>
✔ 상가 유리 시공<br>
✔ 베란다 확장

</p>

</div>

</section>



<section id="portfolio">

<div class="card">

<h2>🛠 시공 사례</h2>

<a href="/portfolio">

<button>

전체 시공 사례 보기 →

</button>

</a>


<div class="slider">

<button class="prev">&#10094;</button>

<div class="slides" id="slides">

{% for img in images %}
<div class="slide">
<img src="{{ img }}" loading="lazy">
</div>
{% endfor %}

{% for img in images %}
<div class="slide clone">
<img src="{{ img }}" loading="lazy">
</div>
{% endfor %}

</div>

<button class="next">&#10095;</button>

</div>

</div>

</section>



<section>

<div class="estimate-card" id="contact">

<h2>무료 견적 요청</h2>

<p>

무료 견적 상담을 받아보세요<br>
빠르고 정확하게 안내드립니다

</p>


<form id="contactForm" enctype="multipart/form-data">

<input type="text" name="name" placeholder="이름" required>

<input type="text" name="phone" placeholder="연락처" required>

<textarea name="message" placeholder="문의 내용"></textarea>

<input type="file" name="image">

<button type="submit">

견적 요청하기

</button>

</form>

</div>

</section>



<!-- 전화 버튼 -->

<a href="tel:01071372313"

style="

position:fixed;
bottom:20px;
right:20px;
background:#22c55e;
color:white;
padding:15px 20px;
border-radius:50px;
text-decoration:none;
box-shadow:0 4px 10px rgba(0,0,0,0.3);

">

📞 바로 전화

</a>



<!-- 모달 -->

<div id="successModal" class="modal">

<div class="modal-box">

<h3>문의가 접수되었습니다</h3>

<button onclick="closeModal()">확인</button>

</div>

</div>



<div class="modal" id="imageModal">

<img id="modalImage">

</div>



<!-- 회원가입 모달 -->

<div id="signupModal" class="signup-modal">

<div class="signup-container">

<!-- 기존 내용 그대로 유지 -->

</div>

</div>



{% endblock %}

<script>

window.addEventListener("scroll", function(){

    const header = document.getElementById("mainHeader");

});

</script>

<div id="signupModal" class="signup-modal">
<div class="signup-container">

<div class="signup-header">
<div class="signup-title">회원가입</div>
<div class="signup-close" onclick="closeSignup()">×</div>
</div>

<div class="signup-steps">
<div class="step active" id="step1-ind">약관동의</div>
<div class="step" id="step2-ind">정보입력</div>
<div class="step" id="step3-ind">완료</div>
</div>

<!-- STEP 1 약관 -->
<div id="step1" class="signup-step active">

<label class="agree-all">
<input type="checkbox" id="agreeAll">
전체 동의
</label>

<div class="agree-box">

<div class="agree-header">
<label>
<input type="checkbox" class="agree-item">
이용약관 동의 (필수)
</label>

<span class="toggle-btn"
onclick="toggleTerms('terms1')">
펼치기
</span>

</div>

<div id="terms1" class="terms-content">

<b>건진창호 이용약관</b><br><br>

<b>제1조 (목적)</b><br>
본 약관은 건진창호(이하 "회사")가 운영하는 웹사이트에서 제공하는 서비스의 이용과 관련하여 회사와 이용자의 권리, 의무 및 책임사항을 규정함을 목적으로 합니다.<br><br>

<b>제2조 (정의)</b><br>
"웹사이트"란 회사가 제공하는 견적 요청, 문의, 정보 제공 등의 서비스를 이용할 수 있도록 제공하는 인터넷 사이트를 의미합니다.<br><br>

"이용자"란 본 약관에 따라 회사가 제공하는 서비스를 이용하는 회원 및 비회원을 말합니다.<br><br>

"회원"이란 웹사이트에 회원가입을 하고 회사가 제공하는 서비스를 이용하는 자를 말합니다.<br><br>

"비회원"이란 회원가입 없이 서비스를 이용하는 자를 말합니다.<br><br>

<b>제3조 (약관의 효력 및 변경)</b><br>
본 약관은 웹사이트에 게시함으로써 효력이 발생합니다.<br><br>

회사는 관련 법령을 위반하지 않는 범위에서 본 약관을 변경할 수 있습니다.<br><br>

변경된 약관은 웹사이트에 공지함으로써 효력이 발생합니다.<br><br>

<b>제4조 (서비스의 제공)</b><br>
회사는 다음과 같은 서비스를 제공합니다.<br><br>

샷시 시공 정보 제공<br>
견적 요청 서비스<br>
문의 접수 및 답변 서비스<br>
기타 회사가 제공하는 서비스<br><br>

<b>제5조 (회원가입)</b><br>
이용자는 회사가 정한 양식에 따라 회원가입을 신청할 수 있습니다.<br><br>

회사는 다음의 경우 회원가입을 거부할 수 있습니다.<br><br>

허위 정보를 입력한 경우<br>
타인의 정보를 도용한 경우<br>
기타 회사가 필요하다고 인정하는 경우<br><br>

<b>제6조 (회원의 의무)</b><br>
회원은 다음 행위를 하여서는 안 됩니다.<br><br>

허위 정보 입력<br>
타인의 정보 도용<br>
웹사이트 운영 방해<br>
법령에 위반되는 행위<br>
기타 회사에 손해를 끼치는 행위<br><br>

<b>제7조 (서비스 이용 제한)</b><br>
회사는 다음의 경우 서비스 이용을 제한할 수 있습니다.<br><br>

약관을 위반한 경우<br>
불법 행위를 한 경우<br>
웹사이트 운영에 지장을 주는 경우<br><br>

<b>제8조 (서비스 중단)</b><br>
회사는 다음의 경우 서비스 제공을 일시적으로 중단할 수 있습니다.<br><br>

서버 점검<br>
시스템 장애<br>
기타 불가피한 사유<br><br>

<b>제9조 (책임의 제한)</b><br>
회사는 이용자의 귀책사유로 발생한 문제에 대해 책임을 지지 않습니다.<br><br>

회사는 웹사이트 이용으로 발생한 간접적 손해에 대해 책임을 지지 않습니다.<br><br>

회사는 이용자가 제공한 정보의 정확성에 대해 책임을 지지 않습니다.<br><br>

<b>제10조 (개인정보 보호)</b><br>
회사는 관련 법령에 따라 이용자의 개인정보를 보호하며, 개인정보 처리에 관한 사항은 개인정보처리방침에 따릅니다.<br><br>

<b>제11조 (분쟁 해결)</b><br>
본 약관과 관련된 분쟁은 대한민국 법령을 따릅니다.<br><br>

<b>제12조 (관할 법원)</b><br>
본 약관과 관련된 분쟁은 회사 본점 소재지를 관할하는 법원을 관할 법원으로 합니다.<br><br>

<b>부칙</b><br>
본 약관은 2026년 2월 18일부터 시행됩니다.

</div>

</div>

<div class="agree-box">

<div class="agree-header">
<label>
<input type="checkbox" class="agree-item">
개인정보처리방침 동의 (필수)
</label>

<span class="toggle-btn" onclick="toggleTerms('terms3')">펼치기</span>
</div>

<div id="terms3" class="terms-content">

<b>건진창호 개인정보처리방침</b><br><br>

건진창호(이하 "회사")는 이용자의 개인정보를 중요하게 생각하며, 「개인정보 보호법」 등 관련 법령을 준수합니다.<br><br>

<b>제1조 (수집하는 개인정보 항목)</b><br>
1. 회원가입 시<br>
이름<br>
아이디<br>
비밀번호<br>
전화번호<br>
거주지역<br><br>

2. 문의 및 견적 요청 시<br>
이름<br>
전화번호<br>
문의 내용<br><br>

3. 자동 수집 항목<br>
IP 주소<br>
접속 로그<br>
브라우저 정보<br><br>

<b>제2조 (개인정보 수집 및 이용 목적)</b><br>
회원 관리<br>
견적 상담 및 문의 답변<br>
서비스 제공 및 운영<br>
고객 문의 대응<br>
서비스 개선<br><br>

<b>제3조 (개인정보 보유 및 이용 기간)</b><br>
목적 달성 후 지체 없이 파기합니다.<br><br>

예외:<br>
계약 또는 청약 철회 기록: 5년<br>
분쟁 처리 기록: 3년<br>
접속 기록: 3개월<br><br>

<b>제4조 (개인정보의 제3자 제공)</b><br>
회사는 개인정보를 외부에 제공하지 않습니다.<br><br>

<b>제5조 (개인정보 보호)</b><br>
접근 제한<br>
보안 시스템 운영<br>
관리자 접근 통제<br><br>

<b>제6조 (이용자의 권리)</b><br>
개인정보 조회<br>
수정<br>
삭제<br>
회원 탈퇴<br><br>

<b>제7조 (개인정보 파기)</b><br>
전자 파일: 복구 불가능 삭제<br>
종이 문서: 파쇄 또는 소각<br><br>

<b>제8조 (개인정보 보호 책임자)</b><br>
회사명: 건진창호<br>
개인정보 보호 책임자: 건진창호 관리자<br>
연락처: (010-9364-2348)<br><br>

<b>제9조 (개인정보처리방침 변경)</b><br>
관련 법령 및 회사 정책에 따라 변경될 수 있습니다.<br><br>

<b>부칙</b><br>
2026년 2월 18일부터 시행됩니다.

</div>

</div>

<div class="agree-box">

<div class="agree-header">

<label>
<input type="checkbox" class="agree-item">
개인정보 수집 및 이용 동의 (필수)
</label>

<span class="toggle-btn" onclick="toggleTerms('terms2')">
펼치기
</span>

</div>

<div id="terms2" class="terms-content">

<b>건진창호 개인정보 수집 및 이용 동의</b><br><br>

건진창호는 서비스 제공을 위해 아래와 같이 개인정보를 수집 및 이용합니다.<br><br>

<b>1. 수집 항목</b><br><br>

회원가입 시<br>
이름<br>
아이디<br>
비밀번호<br>
전화번호<br>
거주지역<br><br>

문의 및 견적 요청 시<br>
이름<br>
전화번호<br>
문의 내용<br><br>

<b>2. 수집 및 이용 목적</b><br><br>

회원 식별 및 관리<br>
문의 및 견적 상담<br>
서비스 제공 및 운영<br>
고객 응대<br><br>

<b>3. 보유 및 이용 기간</b><br><br>

회원 탈퇴 시까지<br>
또는 수집 목적 달성 시까지<br><br>

단, 관련 법령에 따라 일정 기간 보관할 수 있습니다.<br><br>

<b>4. 동의를 거부할 권리</b><br><br>

이용자는 개인정보 수집 및 이용 동의를 거부할 수 있습니다.<br><br>

단, 동의를 거부할 경우 회원가입 및 서비스 이용이 제한될 수 있습니다.

</div>

<button class="next-btn" onclick="goStep2()" style="margin-top:20px;">
다음 →
</button>

</div>

<!-- STEP 2 정보 입력 -->
<div id="step2" class="signup-step">

<input id="username" placeholder="아이디">

<input id="password" type="password" placeholder="비밀번호">

<input id="name" placeholder="이름">

<div class="phone-row">

<input id="phone" placeholder="전화번호">

<button id="sendBtn"
onclick="sendCode()"
class="verify-btn">

인증요청

</button>

</div>


<div class="phone-row">

<input id="code"
placeholder="인증번호"
oninput="checkCodeInput()">

<button id="verifyBtn"
onclick="verifyCode()"
class="verify-btn">

확인

</button>

<span id="verifyStatus" class="verify-status"></span>

</div>

<div id="timer" class="timer"></div>

<input id="region" placeholder="지역">

<button id="signupBtn"
class="next-btn"
onclick="register()"
disabled
style="opacity:0.5;cursor:not-allowed;">
회원가입
</button>

</div>

<!-- STEP 3 완료 -->
<div id="step3" class="signup-step">

<div class="complete">
회원가입 완료
</div>

<button class="next-btn" onclick="closeSignup()">
닫기
</button>

</div>

</div>
</div>
</div>
{% endblock %}

{% block extra_script %}
<script>

const slidesContainer =
document.getElementById("slides");

const slides =
document.querySelectorAll(".slide");

let index = 0;
let isPaused = false;

const visibleSlides = 3;

function updateSlides(animate=true){

    const slideWidth =
        slides[0].offsetWidth + 20;

    if(!animate){

        slidesContainer.style.transition = "none";

    }else{

        slidesContainer.style.transition = "transform 0.5s ease";

    }

    slidesContainer.style.transform =
        `translateX(-${index * slideWidth}px)`;

}

// 다음
function nextSlide(){

    index++;

    updateSlides(true);

    if(index >= slides.length - visibleSlides){

        setTimeout(()=>{

            index = 0;

            updateSlides(false);

        },500);

    }

}

// 이전
function prevSlide(){

    if(index === 0){

        index = slides.length - visibleSlides;

        updateSlides(false);

    }

    index--;

    updateSlides(true);

}

document.querySelector(".next").onclick = nextSlide;
document.querySelector(".prev").onclick = prevSlide;

// 자동 슬라이드
setInterval(()=>{

    if(!isPaused){

        nextSlide();

    }

},4000);

// hover 정지
slidesContainer.addEventListener("mouseenter",()=>{

    isPaused = true;

});

slidesContainer.addEventListener("mouseleave",()=>{

    isPaused = false;

});

// 시작
updateSlides(false);


const modal = document.getElementById("imageModal");
const modalImg = document.getElementById("modalImage");

document.querySelectorAll(".slide img").forEach(img => {

    img.addEventListener("click", () => {

        modal.classList.add("closeable");

        modalImg.src =
            img.dataset.full || img.src;

    });

});

modal.addEventListener("click", () => {

    modal.classList.remove("closeable");

});

function closeModal(){
document.getElementById("successModal").style.display="none";
}

// contact 이동 스크롤
window.addEventListener("load", function(){

    if(window.location.hash === "#contact"){

        const el = document.getElementById("contact");

        if(el){
            el.scrollIntoView({
                behavior:"smooth"
            });
        }

    }

});

// 문의 등록 → 팝업 처리
document.getElementById("contactForm")
.addEventListener("submit", function(e){

    e.preventDefault();

    const formData = new FormData(this);

    fetch("/contact", {

        method:"POST",
        body:formData

    })
    .then(res=>{

        document.getElementById("successModal")
        .style.display="flex";

        document.getElementById("contactForm").reset();

    });

});


// 문의 조회 팝업 열기
function openInquiryModal(){

    document.getElementById("inquiryModal").style.display="flex";

}


// 문의 조회 팝업 닫기
function closeInquiryModal(){

    document.getElementById("inquiryModal").style.display="none";

}


// 문의 조회
function searchInquiry(){

    const name =
        document.getElementById("searchName").value;

    const phone =
        document.getElementById("searchPhone").value;

    fetch("/search_inquiry",{

        method:"POST",

        headers:{
            "Content-Type":"application/json"
        },

        body:JSON.stringify({
            name:name,
            phone:phone
        })

    })

    .then(res=>res.json())

    .then(data=>{

        let html="";

        if(data.length === 0){

            html="<p>조회된 문의가 없습니다.</p>";

        }else{

            data.forEach(item=>{

                html+=`
                <div style="
                    border:1px solid #ddd;
                    padding:10px;
                    margin:10px 0;
                    border-radius:8px;
                ">

                <b>문의내용:</b><br>
                ${item.message}<br><br>

                <b>답변:</b><br>
                ${item.reply || "답변 대기중"}<br>

                ${item.file ? `

                <div style="margin-top:8px;">

                ${(() => {

                const filename =
                item.file.split('/').pop().split('?')[0];

                const ext =
                filename.split('.').pop().toLowerCase();

                if(['jpg','jpeg','png','gif','webp'].includes(ext)){

                return `
                <a href="${item.file}" target="_blank">
                <img src="${item.file}"
                style="
                max-width:120px;
                border-radius:8px;
                display:block;
                margin-bottom:5px;
                ">
                </a>
                `;

                }else{

                let icon="📎";

                if(ext==="pdf") icon="📄";
                else if(ext==="xls"||ext==="xlsx") icon="📊";
                else if(ext==="zip") icon="📦";

                return `
                <a href="${item.file}" target="_blank">
                ${icon} ${filename}
                </a>
                `;

                }

                })()}

                </div>

                ` : ''}

                <br>

                <b>상태:</b> ${item.status}<br>

                <b>날짜:</b> ${item.created_at}

                </div>
                `;

            });

        }

        document.getElementById("inquiryResult")
        .innerHTML=html;

    });

}

function openSignup(){
document.getElementById("signupModal").style.display="flex";
}

function closeSignup(){

    const modal = document.getElementById("signupModal");

    // 모달 닫기
    modal.style.display="none";

    // STEP 초기화 (약관동의)
    showStep(1);

    // 전체동의 + 개별동의 초기화
    document.querySelectorAll(".agree-item, #agreeAll")
    .forEach(cb=>{
        cb.checked=false;
    });

    // 입력값 초기화
    document.querySelectorAll("#signupModal input")
    .forEach(input=>{
        input.value="";
        input.disabled=false;   // 인증 후 disabled된 것도 복구
    });

    // 인증 상태 초기화
    verified=false;

    // 회원가입 버튼 초기화
    const signupBtn=document.getElementById("signupBtn");
    if(signupBtn){
        signupBtn.disabled=true;
        signupBtn.style.opacity="0.5";
        signupBtn.style.cursor="not-allowed";
    }

    // 인증 버튼 초기화
    const verifyBtn=document.getElementById("verifyBtn");
    if(verifyBtn){
        verifyBtn.disabled=false;
    }

    const sendBtn=document.getElementById("sendBtn");
    if(sendBtn){
        sendBtn.disabled=false;
        sendBtn.innerText="인증요청";
    }

    // 상태 텍스트 초기화
    const verifyStatus=document.getElementById("verifyStatus");
    if(verifyStatus) verifyStatus.innerText="";

    const timer=document.getElementById("timer");
    if(timer) timer.innerText="";

}

function toggleTerms(id){

let el=document.getElementById(id);

el.style.display=
el.style.display=="block" ? "none":"block";

}

document.addEventListener("DOMContentLoaded", function(){

const agreeAll = document.getElementById("agreeAll");

if(agreeAll){

agreeAll.onclick=function(){

document.querySelectorAll(".agree-item")
.forEach(cb=>cb.checked=this.checked);

};

}

});

function goStep2(){

let ok=true;

document.querySelectorAll(".agree-item")
.forEach(cb=>{
if(!cb.checked) ok=false;
});

if(!ok){

alert("필수 약관에 동의하세요");

return;

}

showStep(2);

}

let verified=false;
let timerInterval;
let resendCooldown=false;


function sendCode(){

if(resendCooldown){

alert("잠시 후 다시 시도하세요");

return;

}

if(!phone.value){

alert("전화번호 입력");

return;

}

fetch("/send_sms",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
phone:phone.value
})

})
.then(res=>res.json())
.then(data=>{

sendBtn.disabled=true;

sendBtn.innerText="전송됨";

verifyStatus.innerText="인증번호 전송";
verifyStatus.className="verify-status";

startTimer();

resendCooldown=true;

setTimeout(()=>{

sendBtn.disabled=false;
sendBtn.innerText="재전송";

resendCooldown=false;

},30000);

});

}



function verifyCode(){

fetch("/verify_sms",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({

phone:phone.value,
code:code.value

})

})
.then(res=>res.json())
.then(data=>{

if(data.status=="ok"){

verified=true;

verifyStatus.innerText="✔ 인증완료";
verifyStatus.className="verify-status verify-success";

signupBtn.disabled=false;
signupBtn.style.opacity="1";
signupBtn.style.cursor="pointer";

verifyBtn.disabled=true;
code.disabled=true;

clearInterval(timerInterval);

}

else{

verifyStatus.innerText="✖ 인증실패";
verifyStatus.className="verify-status verify-fail";

}

});

}



function checkCodeInput(){

verifyStatus.innerText="";

}

function startTimer(){

let time=180;

clearInterval(timerInterval);

timerInterval=setInterval(()=>{

let min=Math.floor(time/60);
let sec=time%60;

timer.innerText=
`인증시간 ${min}:${sec.toString().padStart(2,"0")}`;

time--;

if(time<0){

clearInterval(timerInterval);

timer.innerText="시간 만료";

}

},1000);

}

function register(){

if(!verified){
alert("전화번호 인증 필요");
return;
}

fetch("/register",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
username:username.value,
password:password.value,
name:name.value,
phone:phone.value,
region:region.value
})

})
.then(res=>res.json())
.then(data=>{
showStep(3);
});

}

function showStep(step){

document.querySelectorAll(".signup-step")
.forEach(el=>el.classList.remove("active"));

document.getElementById("step"+step)
.classList.add("active");

document.querySelectorAll(".step")
.forEach(el=>el.classList.remove("active"));

document.getElementById("step"+step+"-ind")
.classList.add("active");

}

// ESC 키로 닫기
document.addEventListener("keydown", function(e){

    if(e.key === "Escape"){

        const modal = document.getElementById("signupModal");

        if(modal.style.display === "flex"){
            closeSignup();
        }

    }

});

// 바깥 클릭 시 닫기
document.getElementById("signupModal")
.addEventListener("click", function(e){

    if(e.target === this){
        closeSignup();
    }

});

</script>
{% endblock %}
