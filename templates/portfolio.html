{% extends "base.html" %}

{% block title %}ì‹œê³µ ì‚¬ë¡€ | ê±´ì§„ì°½í˜¸{% endblock %}

{% block extra_style %}
<style>

.page-wrap{
    max-width:1100px;
    margin:60px auto;
    padding:0 20px;
}

.page-title{
    font-size:32px;
    font-weight:700;
    margin-bottom:40px;
    text-align:center;
}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:25px;
}

.card.fade-up{
    transform:
        translate3d(0,50px,0)
        scale(0.94);

    transition:
        opacity 1.6s cubic-bezier(0.22,1,0.36,1),
        transform 1.6s cubic-bezier(0.22,1,0.36,1);
}
.card{
    background:white;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    transition:
        transform 0.35s ease,
        box-shadow 0.35s ease;
}

.card img{
    width:100%;
    height:200px;
    object-fit:cover;
}

.card-body{
    padding:15px;
}

.card-title{
    font-size:16px;
    font-weight:600;
}

.card-sub{
    font-size:13px;
    color:#777;
    margin-top:5px;
}

/* ê´€ë¦¬ì ë²„íŠ¼ */
.admin-box{
    margin-top:10px;
    display:flex;
    gap:5px;
}

.admin-box button{
    font-size:12px;
    padding:5px 8px;
    border:none;
    border-radius:5px;
    cursor:pointer;
}

.edit-btn{
    background:#2563eb;
    color:white;
}

.delete-btn{
    background:#dc2626;
    color:white;
}

.save-btn{
    background:#16a34a;
    color:white;
}

.cancel-btn{
    background:#6b7280;
    color:white;
}

.edit-form{
    display:none;
    margin-top:10px;
}

.edit-form input{
    width:100%;
    margin-bottom:5px;
    padding:5px;
}

</style>
{% endblock %}


{% block content %}

<div class="page-wrap">

<div class="page-title">
ì‹œê³µ ì‚¬ë¡€
</div>

<div class="grid">

{% for id, img, date, location, category, type in images %}

<div class="card">

<img src="{{ img }}">

<div class="card-body">

<div class="card-title">
{{ category }}
</div>

<div class="card-sub">
ğŸ“ {{ location }}
</div>

<div class="card-sub">
ğŸ“… {{ date }}
</div>

<div class="card-sub">
{{ type }}
</div>

{% if is_admin %}

<div class="admin-box">

<button class="edit-btn"
onclick="toggleEdit('{{ id }}')">
ìˆ˜ì •
</button>

<form action="/admin/delete_portfolio/{{ id }}"
method="POST">
<button class="delete-btn">
ì‚­ì œ
</button>
</form>

</div>

<form class="edit-form"
id="form-{{ id }}"
onsubmit="saveEdit(event,'{{ id }}')">

<input name="date"
value="{{ date }}"
placeholder="ì‹œê³µ ë‚ ì§œ">

<input name="location"
value="{{ location }}"
placeholder="ì‹œê³µ ìœ„ì¹˜">

<input name="category"
value="{{ category }}"
placeholder="ì¹´í…Œê³ ë¦¬">

<input name="type"
value="{{ type }}"
placeholder="Before / After">

<button class="save-btn">
ì €ì¥
</button>

<button type="button"
class="cancel-btn"
onclick="toggleEdit('{{ id }}')">
ì·¨ì†Œ
</button>

</form>

{% endif %}

</div>

</div>

{% endfor %}

</div>

</div>

{% endblock %}


{% block extra_script %}
<script>

function toggleEdit(id){

const form =
document.getElementById("form-"+id);

if(form.style.display==="block"){
form.style.display="none";
}else{
form.style.display="block";
}

}

function saveEdit(e,id){

e.preventDefault();

const form =
document.getElementById("form-"+id);

const data =
new FormData(form);

fetch("/admin/update_portfolio/"+id,{
method:"POST",
body:data
})
.then(()=>{
location.reload();
});

}

</script>
{% endblock %}
