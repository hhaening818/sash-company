<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ì‹œê³µ ì‚¬ë¡€ | SASH COMPANY</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>

:root{
    --main:#2f7d32;
    --dark:#1b3a2f;
    --light:#f4f7f6;
}

/* ì „ì²´ */
body{
    margin:0;
    font-family:'Noto Sans KR',sans-serif;
    background:white;
    color:#1b3a2f;
}

/* í—¤ë” (íšŒì‚¬ì†Œê°œì™€ ë™ì¼) */
.header{
    background:white;
    height:70px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 60px;
    border-bottom:1px solid #e5ece9;
    box-shadow:0 2px 8px rgba(0,0,0,0.04);
}

.logo{
    font-size:22px;
    font-weight:700;
    color:var(--main);
    cursor:pointer;
}

.nav{
    display:flex;
    gap:35px;
}

.nav a{
    text-decoration:none;
    color:#4a6358;
    font-weight:500;
}

.nav a.active{
    color:var(--main);
    font-weight:700;
}

/* í˜ì´ì§€ ì œëª© */
.page-title{
    text-align:center;
    padding:60px 20px 30px;
}

.page-title h1{
    font-size:36px;
    margin-bottom:10px;
}

.page-title p{
    color:#666;
}

/* ê°¤ëŸ¬ë¦¬ */
.gallery{
    max-width:1200px;
    margin:30px auto 80px;
    padding:0 20px;
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
    gap:30px;
}

/* ì¹´ë“œ */
.card{
    background:white;
    border-radius:14px;
    overflow:hidden;
    box-shadow:0 4px 14px rgba(0,0,0,0.06);
    transition:0.25s;
}

.card:hover{
    transform:translateY(-6px);
    box-shadow:0 8px 24px rgba(0,0,0,0.1);
}

.card img{
    width:100%;
    height:200px;
    object-fit:cover;
    cursor:pointer;
}

/* ì¹´ë“œ í•˜ë‹¨ */
.card-body{
    padding:15px;
}

.card-title{
    font-weight:600;
    margin-bottom:5px;
}

.card-sub{
    font-size:14px;
    color:#777;
}

/* ì‚­ì œ ë²„íŠ¼ */
.delete-btn{
    margin-top:10px;
    background:#ef4444;
    color:white;
    border:none;
    padding:6px 12px;
    border-radius:6px;
    cursor:pointer;
}

/* ì—…ë¡œë“œ ì˜ì—­ */
.upload-section{
    max-width:800px;
    margin:30px auto;
    padding:20px;
    border:2px dashed #cbd5e1;
    border-radius:12px;
    text-align:center;
    background:var(--light);
}

/* ëª¨ë‹¬ */
.modal{
    display:none;
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.9);
    justify-content:center;
    align-items:center;
    z-index:999;
}

.modal img{
    max-width:90%;
    max-height:90%;
}

</style>
</head>

<body>

<!-- í—¤ë” -->
<div class="header">

<div class="logo" onclick="location.href='/'">
SASH COMPANY
</div>

<div class="nav">

<a href="/about">íšŒì‚¬ì†Œê°œ</a>

<a href="/construction">ì‹œê³µ ë¶„ì•¼</a>

<a href="/portfolio" class="active">ì‹œê³µ ì‚¬ë¡€</a>

<a href="/inquiries">ë¬¸ì˜ ëª©ë¡</a>

<a href="/#contact">ë¬¸ì˜í•˜ê¸°</a>

</div>

</div>


<!-- ì œëª© -->
<div class="page-title">

<h1>ì‹œê³µ ì‚¬ë¡€</h1>

<p>ê±´ì§„ì°½í˜¸ì˜ ì‹¤ì œ ì‹œê³µ í˜„ì¥ì„ í™•ì¸í•´ë³´ì„¸ìš”</p>

</div>


<!-- ê´€ë¦¬ì ì—…ë¡œë“œ -->
{% if is_admin %}

<div class="upload-section">

<form id="uploadForm" enctype="multipart/form-data">

<input type="file" name="image" id="fileInput" multiple>

<br><br>

<button type="submit">
ì‚¬ì§„ ì—…ë¡œë“œ
</button>

</form>

</div>

{% endif %}


<!-- ê°¤ëŸ¬ë¦¬ -->
<div class="gallery">

{% for id, img, date, location, category, type in images %}

<div class="card">

<img src="{{ img }}">

<div style="padding:15px">

<div><b>{{ category }}</b></div>

<div>ğŸ“ {{ location }}</div>

<div>ğŸ“… {{ date }}</div>

<div>ğŸ”§ {{ type }}</div>

{% if is_admin %}

<button onclick="openEdit(
'{{ id }}',
'{{ date }}',
'{{ location }}',
'{{ category }}',
'{{ type }}'
)">
ìˆ˜ì •
</button>

<form action="/admin/delete_portfolio/{{ id }}" method="POST">
<button type="submit">ì‚­ì œ</button>
</form>

{% endif %}

</div>

</div>

<!-- ëª¨ë‹¬ -->
<div class="modal" id="modal" onclick="closeModal()">

<img id="modalImg">

</div>

<div id="editModal" style="display:none; position:fixed; top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);">

<div style="background:white;padding:20px;margin:100px auto;width:300px">

<form id="editForm">

<input type="hidden" id="editId">

ë‚ ì§œ<br>
<input type="date" id="editDate"><br>

ìœ„ì¹˜<br>
<input type="text" id="editLocation"><br>

ì¹´í…Œê³ ë¦¬<br>
<select id="editCategory">
<option>ì•„íŒŒíŠ¸</option>
<option>ì£¼íƒ</option>
<option>ìƒê°€</option>
</select><br>

êµ¬ë¶„<br>
<select id="editType">
<option>before</option>
<option>after</option>
</select><br><br>

<button type="submit">ì €ì¥</button>

<button type="button" onclick="closeEdit()">ì·¨ì†Œ</button>

</form>

</div>
</div>

<script>

function openModal(src){

document.getElementById("modal").style.display="flex";
document.getElementById("modalImg").src=src;

}

function closeModal(){

document.getElementById("modal").style.display="none";

}

</script>


<script>

const form = document.getElementById("uploadForm");

if(form){

form.addEventListener("submit",function(e){

e.preventDefault();

let files = document.getElementById("fileInput").files;

for(let file of files){

let data=new FormData();
data.append("image",file);

fetch("/admin/upload_portfolio",{
method:"POST",
body:data
})
.then(()=>location.reload());

}

});

}

function openEdit(id,date,location,category,type){

document.getElementById("editModal").style.display="block";

document.getElementById("editId").value=id;
document.getElementById("editDate").value=date;
document.getElementById("editLocation").value=location;
document.getElementById("editCategory").value=category;
document.getElementById("editType").value=type;

}

function closeEdit(){
document.getElementById("editModal").style.display="none";
}

document.getElementById("editForm").onsubmit=function(e){

e.preventDefault();

let id=document.getElementById("editId").value;

let data=new FormData();

data.append("date",editDate.value);
data.append("location",editLocation.value);
data.append("category",editCategory.value);
data.append("type",editType.value);

fetch("/admin/update_portfolio/"+id,{
method:"POST",
body:data
})
.then(()=>{
location.reload();
})

}

</script>

</body>
</html>
